

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-CN" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-CN" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>分类模型 &mdash; 动手学深度学习  文档</title>
  

  
  
    <link rel="shortcut icon" href="../_static/gluon_s2.png"/>
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gluon.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Softmax回归——从零开始" href="softmax-regression-scratch.html" />
    <link rel="prev" title="线性回归——使用Gluon" href="linear-regression-gluon.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> 动手学深度学习
          

          
            
            <img src="../_static/gluon_white.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../chapter_preface/index.html">前言</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_crashcourse/index.html">预备知识</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">深度学习基础</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="shallow-model.html">单层神经网络</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear-regression-scratch.html">线性回归——从零开始</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear-regression-gluon.html">线性回归——使用Gluon</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">分类模型</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Softmax运算">Softmax运算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#单样本分类的矢量计算表达式">单样本分类的矢量计算表达式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#小批量样本分类的矢量计算表达式">小批量样本分类的矢量计算表达式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#交叉熵损失函数">交叉熵损失函数</a></li>
<li class="toctree-l3"><a class="reference internal" href="#模型预测及评价">模型预测及评价</a></li>
<li class="toctree-l3"><a class="reference internal" href="#小结">小结</a></li>
<li class="toctree-l3"><a class="reference internal" href="#练习">练习</a></li>
<li class="toctree-l3"><a class="reference internal" href="#扫码直达讨论区">扫码直达讨论区</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="softmax-regression-scratch.html">Softmax回归——从零开始</a></li>
<li class="toctree-l2"><a class="reference internal" href="softmax-regression-gluon.html">Softmax回归——使用Gluon</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi-layer.html">多层神经网络</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlp-scratch.html">多层感知机——从零开始</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlp-gluon.html">多层感知机——使用Gluon</a></li>
<li class="toctree-l2"><a class="reference internal" href="underfit-overfit.html">欠拟合、过拟合和模型选择</a></li>
<li class="toctree-l2"><a class="reference internal" href="reg-scratch.html">正则化——从零开始</a></li>
<li class="toctree-l2"><a class="reference internal" href="reg-gluon.html">正则化——使用Gluon</a></li>
<li class="toctree-l2"><a class="reference internal" href="dropout-scratch.html">丢弃法——从零开始</a></li>
<li class="toctree-l2"><a class="reference internal" href="dropout-gluon.html">丢弃法——使用Gluon</a></li>
<li class="toctree-l2"><a class="reference internal" href="backprop.html">正向传播和反向传播</a></li>
<li class="toctree-l2"><a class="reference internal" href="kaggle-gluon-kfold.html">实战Kaggle比赛：预测房价</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_gluon-basics/index.html">深度学习计算</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_convolutional-neural-networks/index.html">卷积神经网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_recurrent-neural-networks/index.html">循环神经网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_optimization/index.html">优化算法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_gluon-advances/index.html">计算性能</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_computer-vision/index.html">计算机视觉</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_natural-language-processing/index.html">自然语言处理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chapter_appendix/index.html">附录</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">动手学深度学习</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">深度学习基础</a> &raquo;</li>
        
      <li>分类模型</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/chapter_supervised-learning/classification.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="分类模型">
<h1>分类模型<a class="headerlink" href="#分类模型" title="永久链接至标题">¶</a></h1>
<p>前几节介绍的线性回归模型适用于输出为连续值的情景，例如输出为房价。在其他情景中，模型输出还可以是一个离散值，例如图片类别。对于这样的分类问题，我们可以使用分类模型，例如Softmax回归。和线性回归不同，Softmax回归的输出单元从一个变成了多个。本节以Softmax回归模型为例，介绍神经网络中的分类模型。Softmax回归是一个单层神经网络。</p>
<p>让我们考虑一个简单的分类问题。为了便于讨论，让我们假设输入图片的尺寸为<span class="math">\(2 \times 2\)</span>，并设图片的四个特征值，即像素值分别为<span class="math">\(x_1, x_2, x_3, x_4\)</span>。假设训练数据集中图片的真实标签为狗、猫或鸡，这些标签分别对应离散值<span class="math">\(y_1, y_2, y_3\)</span>。举个例子，如果<span class="math">\(y_1=0, y_2=1, y_3=2\)</span>，任意一张狗图片的标签记作0。</p>
<div class="section" id="Softmax运算">
<h2>Softmax运算<a class="headerlink" href="#Softmax运算" title="永久链接至标题">¶</a></h2>
<p>我们将一步步地描述Softmax回归是怎样对单个<span class="math">\(2 \times 2\)</span>图片样本分类的。它将会用到Softmax运算。</p>
<p>设带下标的<span class="math">\(w\)</span>和<span class="math">\(b\)</span>分别为Softmax回归的权重和偏差参数。给定单个图片的输入特征<span class="math">\(x_1, x_2, x_3, x_4\)</span>，我们有</p>
<div class="math">
\[\begin{split}o_1 = x_1 w_{11} + x_2 w_{21} + x_3 w_{31} + x_4 w_{41} + b_1,\\
o_2 = x_1 w_{12} + x_2 w_{22} + x_3 w_{32} + x_4 w_{42} + b_2,\\
o_3 = x_1 w_{13} + x_2 w_{23} + x_3 w_{33} + x_4 w_{43} + b_3.\end{split}\]</div>
<p>图3.2用神经网络图描绘了上面的计算。
和线性回归一样，Softmax回归也是一个单层神经网络。和线性回归有所不同的是，Softmax回归输出层中的输出个数等于类别个数，因此从一个变成了多个。在Softmax回归中，<span class="math">\(o_1, o_2, o_3\)</span>的计算都要依赖于<span class="math">\(x_1, x_2, x_3, x_4\)</span>。所以，Softmax回归的输出层是一个全连接层。</p>
<div class="figure" id="id9">
<img alt="Softmax回归是一个单层神经网络" src="../_images/softmaxreg.svg" /><p class="caption"><span class="caption-text">Softmax回归是一个单层神经网络</span></p>
</div>
<p>在得到输出层的三个输出后，我们需要预测输出分别为狗、猫或鸡的概率。不妨设它们分别为<span class="math">\(\hat{y}_1, \hat{y}_2, \hat{y}_3\)</span>。下面，我们通过对<span class="math">\(o_1, o_2, o_3\)</span>做Softmax运算，得到模型最终输出</p>
<div class="math">
\[\begin{split}\hat{y}_1 = \frac{ \exp(o_1)}{\sum_{i=1}^3 \exp(o_i)},\\
\hat{y}_2 = \frac{ \exp(o_2)}{\sum_{i=1}^3 \exp(o_i)},\\
\hat{y}_3 = \frac{ \exp(o_3)}{\sum_{i=1}^3 \exp(o_i)}.\end{split}\]</div>
<p>由于<span class="math">\(\hat{y}_1 + \hat{y}_2 + \hat{y}_3 = 1\)</span>且<span class="math">\(\hat{y}_1 \geq 0, \hat{y}_2 \geq 0, \hat{y}_3 \geq 0\)</span>，<span class="math">\(\hat{y}_1, \hat{y}_2, \hat{y}_3\)</span>是一个合法的概率分布。我们可将上面Softmax运算中的三式记作</p>
<div class="math">
\[\hat{y}_1, \hat{y}_2, \hat{y}_3 = \text{Softmax}(o_1, o_2, o_3).\]</div>
<p>我们有时把Softmax运算叫做Softmax层。</p>
</div>
<div class="section" id="单样本分类的矢量计算表达式">
<h2>单样本分类的矢量计算表达式<a class="headerlink" href="#单样本分类的矢量计算表达式" title="永久链接至标题">¶</a></h2>
<p>为了提高计算效率，我们可以将单样本分类通过矢量计算来表达。在上面的图片分类问题中，假设Softmax回归的权重和偏差参数分别为</p>
<div class="math">
\[\begin{split}\boldsymbol{W} =
\begin{bmatrix}
    w_{11} &amp; w_{12} &amp; w_{13} \\
    w_{21} &amp; w_{22} &amp; w_{23} \\
    w_{31} &amp; w_{32} &amp; w_{33} \\
    w_{41} &amp; w_{42} &amp; w_{43}
\end{bmatrix},\quad
\boldsymbol{b} =
\begin{bmatrix}
    b_1 &amp; b_2 &amp; b_3
\end{bmatrix},\end{split}\]</div>
<p>设<span class="math">\(2 \times 2\)</span>图片样本<span class="math">\(i\)</span>的特征为</p>
<div class="math">
\[\boldsymbol{x}^{(i)} = \begin{bmatrix}x_1^{(i)} &amp; x_2^{(i)} &amp; x_3^{(i)} &amp; x_4^{(i)}\end{bmatrix},\]</div>
<p>输出层输出为</p>
<div class="math">
\[\boldsymbol{o}^{(i)} = \begin{bmatrix}o_1^{(i)} &amp; o_2^{(i)} &amp; o_3^{(i)}\end{bmatrix},\]</div>
<p>预测为狗、猫或鸡的概率分布为</p>
<div class="math">
\[\boldsymbol{\hat{y}}^{(i)} = \begin{bmatrix}\hat{y}_1^{(i)} &amp; \hat{y}_2^{(i)} &amp; \hat{y}_3^{(i)}\end{bmatrix}.\]</div>
<p>我们对样本<span class="math">\(i\)</span>分类的矢量计算表达式为</p>
<div class="math">
\[\begin{split}\boldsymbol{o}^{(i)} = \boldsymbol{x}^{(i)} \boldsymbol{W} + \boldsymbol{b},\\
\boldsymbol{\hat{y}}^{(i)} = \text{Softmax}(\boldsymbol{o}^{(i)}).\end{split}\]</div>
</div>
<div class="section" id="小批量样本分类的矢量计算表达式">
<h2>小批量样本分类的矢量计算表达式<a class="headerlink" href="#小批量样本分类的矢量计算表达式" title="永久链接至标题">¶</a></h2>
<p>为了进一步提升计算效率，我们通常对小批量数据做矢量计算。广义上，给定一个小批量样本，其批量大小为<span class="math">\(n\)</span>，输入个数（特征数）为<span class="math">\(x\)</span>，输出个数（类别数）为<span class="math">\(y\)</span>。设批量特征为<span class="math">\(\boldsymbol{X} \in \mathbb{R}^{n \times x}\)</span>，批量标签<span class="math">\(\boldsymbol{y} \in \mathbb{R}^{n \times 1}\)</span>。
假设Softmax回归的权重和偏差参数分别为<span class="math">\(\boldsymbol{W} \in \mathbb{R}^{x \times y}, \boldsymbol{b} \in \mathbb{R}^{1 \times y}\)</span>。Softmax回归的矢量计算表达式为</p>
<div class="math">
\[\begin{split}\boldsymbol{O} = \boldsymbol{X} \boldsymbol{W} + \boldsymbol{b},\\
\boldsymbol{\hat{Y}} = \text{Softmax}(\boldsymbol{O}),\end{split}\]</div>
<p>其中的加法运算使用了广播机制，<span class="math">\(\boldsymbol{O}, \boldsymbol{\hat{Y}} \in \mathbb{R}^{n \times y}\)</span>且这两个矩阵的第<span class="math">\(i\)</span>行分别为<span class="math">\(\boldsymbol{o}^{(i)}\)</span>和<span class="math">\(\boldsymbol{\hat{y}}^{(i)}\)</span>。</p>
</div>
<div class="section" id="交叉熵损失函数">
<h2>交叉熵损失函数<a class="headerlink" href="#交叉熵损失函数" title="永久链接至标题">¶</a></h2>
<p>Softmax回归使用了交叉熵损失函数（cross-entropy
loss）。以本节中的图片分类为例，真实标签狗、猫或鸡分别对应离散值<span class="math">\(y_1, y_2, y_3\)</span>，它们的预测概率分别为<span class="math">\(\hat{y}_1, \hat{y}_2, \hat{y}_3\)</span>。为了便于描述，设样本<span class="math">\(i\)</span>的标签的被预测概率为<span class="math">\(p_{\text{label}_i}\)</span>。例如，如果样本<span class="math">\(i\)</span>的标签为<span class="math">\(y_3\)</span>，那么<span class="math">\(p_{\text{label}_i} = \hat{y}_3\)</span>。直观上，训练数据集上每个样本的真实标签的被预测概率越大（最大为1），分类越准确。假设训练数据集的样本数为<span class="math">\(n\)</span>。由于对数函数是单调递增的，且最大化函数与最小化该函数的相反数等价，我们希望最小化</p>
<div class="math">
\[\ell(\boldsymbol{\Theta}) = -\frac{1}{n} \sum_{i=1}^n \log p_{\text{label}_i},\]</div>
<p>其中<span class="math">\(\boldsymbol{\Theta}\)</span>为模型参数。该函数即交叉熵损失函数。在训练Softmax回归时，我们将使用优化算法来迭代模型参数并不断降低损失函数的值。</p>
</div>
<div class="section" id="模型预测及评价">
<h2>模型预测及评价<a class="headerlink" href="#模型预测及评价" title="永久链接至标题">¶</a></h2>
<p>在训练好Softmax回归模型后，给定任一样本特征，我们可以预测每个输出类别的概率。通常，我们把预测概率最大的类别作为输出类别。如果它与真实类别（标签）一致，说明这次预测是正确的。在下一节的实验中，我们将使用准确率（accuracy）来评价模型的表现。它等于正确预测数量与总预测数量的比。</p>
</div>
<div class="section" id="小结">
<h2>小结<a class="headerlink" href="#小结" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li>Softmax回归适用于分类问题。它使用Softmax运算输出类别的概率分布。</li>
<li>Softmax回归是一个单层神经网络，输出个数等于分类问题中的类别个数。</li>
</ul>
</div>
<div class="section" id="练习">
<h2>练习<a class="headerlink" href="#练习" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li>如果按本节Softmax运算的定义来实现它，可能会有什么问题？</li>
</ul>
</div>
<div class="section" id="扫码直达讨论区">
<h2>扫码直达<a class="reference external" href="https://discuss.gluon.ai/t/topic/6403">讨论区</a><a class="headerlink" href="#扫码直达讨论区" title="永久链接至标题">¶</a></h2>
<div class="figure">
<img alt="" src="../_images/qr_classification.svg" /></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="softmax-regression-scratch.html" class="btn btn-neutral float-right" title="Softmax回归——从零开始" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="linear-regression-gluon.html" class="btn btn-neutral" title="线性回归——使用Gluon" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'zh_CN',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/baidu_tongji.js"></script>
      <script type="text/javascript" src="../_static/google_analytics.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>